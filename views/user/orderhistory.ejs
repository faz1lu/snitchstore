<!--========================================================= 
    Item Name: Ekka - Ecommerce HTML Template.
    Author: ashishmaraviya
    Version: 3.3
    Copyright 2022-2023
	Author URI: https://themeforest.net/user/ashishmaraviya
 ============================================================-->
 <!DOCTYPE html>
 <html lang="en">
 
 
<!-- Mirrored from loopinfosol.in/themeforest/ekka-html-v33/ekka-html/user-history.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 08 Jan 2023 23:19:21 GMT -->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
     
    <title>Ekka - Ecommerce HTML Template.</title>
    <meta name="keywords" content="apparel, catalog, clean, ecommerce, ecommerce HTML, electronics, fashion, html eCommerce, html store, minimal, multipurpose, multipurpose ecommerce, online store, responsive ecommerce template, shops" />
    <meta name="description" content="Best ecommerce html template for single and multi vendor store.">
    <meta name="author" content="ashishmaraviya">

    <!-- site Favicon -->
    <link rel="icon" href="user/images/favicon/favicon.png" sizes="32x32" />
    <link rel="apple-touch-icon" href="user/images/favicon/favicon.png" />
    <meta name="msapplication-TileImage" content="user/images/favicon/favicon.png" />

    <!-- css Icon Font -->
    <link rel="stylesheet" href="user/css/vendor/ecicons.min.css" />

    <!-- css All Plugins Files -->
    <link rel="stylesheet" href="user/css/plugins/animate.css" />
    <link rel="stylesheet" href="user/css/plugins/swiper-bundle.min.css" />
    <link rel="stylesheet" href="user/css/plugins/jquery-ui.min.css" />
    <link rel="stylesheet" href="user/css/plugins/countdownTimer.css" />
    <link rel="stylesheet" href="user/css/plugins/slick.min.css" />
    <link rel="stylesheet" href="user/css/plugins/nouislider.css" />
    <link rel="stylesheet" href="user/css/plugins/bootstrap.css" />

    <!-- Main Style -->
    <link rel="stylesheet" href="user/css/style.css" />
    <link rel="stylesheet" href="user/css/responsive.css" />

    <!-- Background css -->
    <link rel="stylesheet" id="bg-switcher-css" href="user/css/backgrounds/bg-4.css">
    
</head>
<body class="shop_page">
    <div id="ec-overlay"><span class="loader_img"></span></div>

    <!-- Header start  -->
    <%-include('partials/header')  %>     <!-- Header End  -->

    <!-- ekka Cart Start -->

    <!-- ekka Cart End -->

    <!-- Ec breadcrumb start -->
    <div class="sticky-header-next-sec  ec-breadcrumb section-space-mb">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="row ec_breadcrumb_inner">
                        <div class="col-md-6 col-sm-12">
                            <h2 class="ec-breadcrumb-title">User History</h2>
                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Ec breadcrumb end -->

    <!-- User history section -->
    <section class="ec-page-content ec-vendor-uploads ec-user-account section-space-p">
        <div class="container">
            <div class="row">
                <!-- Sidebar Area Start -->
                <div class="ec-shop-leftside ec-vendor-sidebar col-lg-3 col-md-12">
                    <div class="ec-sidebar-wrap">
                        <!-- Sidebar Category Block -->
                        <div class="ec-sidebar-block">
                            <div class="ec-vendor-block">
                                <div class="ec-vendor-block-items">
                                    <ul>
                                        <li><a href="user-profile.html">User Profile</a></li>
                                        <li><a href="user-history.html">History</a></li>
                                        <li><a href="wishlist.html">Wishlist</a></li>
                                        <li><a href="cart.html">Cart</a></li>
                                        <li><a href="checkout.html">Checkout</a></li>
                                        <li><a href="track-order.html">Track Order</a></li>
                                        <li><a href="user-invoice.html">Invoice</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ec-shop-rightside col-lg-9 col-md-12">
                    <div class="ec-vendor-dashboard-card">
                        <div class="ec-vendor-card-header">
                            <h5>Product History</h5>
                            <div class="ec-header-btn">
                                <a class="btn btn-lg btn-primary" href="/shop">Shop Now</a>
                            </div>
                        </div>
                        <div class="ec-vendor-card-body">
                            <div class="ec-vendor-card-table">

                                <table class="table ec-table">
                                    <thead>
                                        <tr>
                                            <th scope="col">ID</th>
                                            <!-- <th scope="col">Image</th> -->
                                            <!-- <th scope="col">Name</th> -->
                                            <th scope="col">Date</th>
                                            <th scope="col">Price</th>
                                            <th scope="col">Status</th>
                                            <th>payment type</th>
                                            <th scope="col">view</th>
                                            <th>action</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% for( let i = 0;i<history.length; i++ ) { %>  
                                            <tr>
                                            
                                             
                                            <th scope="row"><span><%=history[i]._id.toString().substr(15) %> </span></th>
                                            <!-- <td><img class="prod-img" src="<=history[i].produts[j].product.image[0] %>" -->
                                                    <!-- alt="product image"></td> -->
                                             <td><span><%=history[i].date.toLocaleDateString()%> </span></td> 
                                            <td><span><%=history[i].subtotal%> </span></td>
                                            <td><span id="statuses<%=history[i]._id%>"><%=history[i].orderstatus%> </span></td>
                                            <td><span><%=history[i].paymentmethod%></span></td>
                                            <!-- <td><span class="tbl-btn"><a class="btn btn-lg btn-primary"
                                                href="/viewhistory/<=history[i]._id%>">View</a></span></td> -->
                                           <td><a href="/viewhistory/<%=history[i]._id%>" ><i class="fa-solid fa-eye"></i> view</a></td>

                                                <td><span class="tbl-btn"><a class="btn btn-lg btn-primary" onclick="cancelorder('<%=history[i]._id%>')"
                                                    >cancel</a></span> </td> 
                                            </tr>
                                              <% } %>    
                                                     
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- End User history section -->

    <!-- Footer Start -->
    <%-include('partials/footer.ejs')  %> 
    <!-- Feature tools end -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.3/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function cancelorder(id){

        Swal.fire({
  title: 'Do you want to cancel the order?',
  showDenyButton: true,
  showCancelButton: true,
  confirmButtonText: 'YES',
  denyButtonText: `NO`,
}).then((result) => {
  /* Read more about isConfirmed, isDenied below */
  if (result.isConfirmed) {
    Swal.fire('cancelled!', '', 'success')

     axios.post(`/ordercancel?id=${id}`).then((res)=>{
        if(res.data.status){
            document.getElementById(`statuses${id}`).style.color="red"
            document.getElementById(`statuses${id}`).innerHTML="Cancelled"
        }
     })

  } else if (result.isDenied) {
    Swal.fire('Changes are not saved', '', 'info')
  }
})

        }
</script>
    <!-- Vendor JS -->
    <script src="user/js/vendor/jquery-3.5.1.min.js"></script>
    <script src="user/js/vendor/popper.min.js"></script>
    <script src="user/js/vendor/bootstrap.min.js"></script>
    <script src="user/js/vendor/bootstrap-tagsinput.js"></script>
    <script src="user/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="user/js/vendor/modernizr-3.11.2.min.js"></script>
    <script src="user/js/vendor/jquery.magnific-popup.min.js"></script>

    <!--Plugins JS-->
    <script src="user/js/plugins/swiper-bundle.min.js"></script>
    <script src="user/js/plugins/nouislider.js"></script>
    <script src="user/js/plugins/countdownTimer.min.js"></script>
    <script src="user/js/plugins/scrollup.js"></script>
    <script src="user/js/plugins/jquery.zoom.min.js"></script>
    <script src="user/js/plugins/slick.min.js"></script>
    <script src="user/js/plugins/infiniteslidev2.js"></script>
    <script src="user/js/plugins/jquery.sticky-sidebar.js"></script>
    <!-- Google translate Js -->
    <script src="user/js/vendor/google-translate.js"></script>
    <script>
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({ pageLanguage: 'en' }, 'google_translate_element');
        }
    </script>
    <!-- Main Js -->
    <script src="user/js/main.js"></script>

</body>


<!-- Mirrored from loopinfosol.in/themeforest/ekka-html-v33/ekka-html/user-history.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 08 Jan 2023 23:19:21 GMT -->
</html>