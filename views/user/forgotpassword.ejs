<!--========================================================= 
    Item Name: Ekka - Ecommerce HTML Template.
    Author: ashishmaraviya
    Version: 3.3
    Copyright 2022-2023
	Author URI: https://themeforest.net/user/ashishmaraviya
 ============================================================-->
 <!DOCTYPE html>
 <html lang="en">
 
 
<!-- Mirrored from loopinfosol.in/themeforest/ekka-html-v33/ekka-html/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 08 Jan 2023 23:18:35 GMT -->
<head>
     <meta charset="UTF-8">
     <meta http-equiv="x-ua-compatible" content="ie=edge" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
     
     <title></title>
     <meta name="keywords" content="apparel, catalog, clean, ecommerce, ecommerce HTML, electronics, fashion, html eCommerce, html store, minimal, multipurpose, multipurpose ecommerce, online store, responsive ecommerce template, shops" />
     <meta name="description" content="Best ecommerce html template for single and multi vendor store.">
     <meta name="author" content="ashishmaraviya">
     
    <!-- site Favicon -->
    <link rel="icon" href="/user/images/favicon/favicon.png" sizes="32x32" />
    <link rel="apple-touch-icon" href="/user/images/favicon/favicon.png" />
    <meta name="msapplication-TileImage" content="/user/images/favicon/favicon.png" />

    <!-- css Icon Font -->
    <link rel="stylesheet" href="/user/css/vendor/ecicons.min.css" />

    <!-- css All Plugins Files -->
    <link rel="stylesheet" href="/user/css/plugins/animate.css" />
    <link rel="stylesheet" href="/user/css/plugins/swiper-bundle.min.css" />
    <link rel="stylesheet" href="/user/css/plugins/jquery-ui.min.css" />
    <link rel="stylesheet" href="/user/css/plugins/countdownTimer.css" />
    <link rel="stylesheet" href="/user/css/plugins/slick.min.css" />
    <link rel="stylesheet" href="/user/css/plugins/nouislider.css" />
    <link rel="stylesheet" href="/user/css/plugins/bootstrap.css" />

    <!-- Main Style -->
    <link rel="stylesheet" href="/user/css/style.css" />
    <link rel="stylesheet" href="/user/css/responsive.css" />

    <!-- Background css -->
    <link rel="stylesheet" id="bg-switcher-css" href="/user/css/backgrounds/bg-4.css">
    
</head>
<body>
    <div id="ec-overlay"><span class="loader_img"></span></div>

    <!-- Header start  -->

    <%-include('partials/header')  %> 
      <!-- Header End  -->

    <!-- ekka Cart Start -->
    <div class="ec-side-cart-overlay"></div>
    
    <!-- ekka Cart End -->

    <!-- Ec breadcrumb start -->
    <div class="sticky-header-next-sec  ec-breadcrumb section-space-mb">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="row ec_breadcrumb_inner">
                        <div class="col-md-6 col-sm-12">
                            <h2 class="ec-breadcrumb-title">forgotpassword</h2>
                        </div>
                       
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Ec breadcrumb end -->

    <!-- Ec login page -->
    <section class="ec-page-content section-space-p">
        <div class="container">
            <div class="row">
                <div class="col-md-12 text-center">
                    <div class="section-title">
                        <!-- <h2 class="ec-bg-title">forgot password</h2> -->
                        <!-- <h2 class="ec-title" style="color: darkblue; font-weight:15px;"><b>forgotpassword</b></h2> -->
                        <!-- <p class="sub-title mb-3" style="color: darkblue;">Best place for your fashion</p> -->
                    </div>
                </div>
                <div class="ec-login-wrapper">
                    <div class="ec-login-container">
                        <div class="ec-login-form" id="superdiv">
                            <form id="form">
                                <span class="ec-login-wrap">
                                    <label style="color: darkblue;">enter your email address</label>
                                    <input id="email" type="text" name="email" placeholder="Email.." required onkeyup="emailkey()" />
                                    <p
                                    class="float-start text-danger mb-1 fw-light opacity-75"
                                    id="emailwarning" ></p>
                                </span>
                               
                                <!-- <span class="ec-login-wrap">
                                    <label style="color: darkblue;"></label>
                                    <input type="password"  id="password" name="password" placeholder="reset password" required onkeyup="passwordkey()"/>
                                    <p
                                    class="float-start text-danger mb-1 fw-light opacity-75"
                                    id="passwordwarning"
                                ></p>
                                </span> -->
                           

                                <a class="btn-primary" style="width: 70px; height: 30px; text-align: center; margin-left: 353px;" onclick="validate()">verify</a>
                              
                                <span class="ec-login-wrap ec-login-fp">
                                    <label><a href="/userlogin" style="color: darkblue;">back to login</a></label>
                                </span>
                                <span class="ec-login-wrap ec-login-btn">
                                    
                                    <!-- <button class="btn btn-primary" type="submit" style="height: 33px; width: 80px;" onclick="validate()">Login</button> -->
                                    <p class="text-danger" id="errmsg"></p>
                                    <!-- <a href="/userregister" class="btn btn-secondary">Register</a> -->
                                </span>
                                <!-- <div class="mt-5">
                                <span >
                                     <button class="btn btn-primary" type="submit" style="height: 30px; width: 80px;">Login</button> -->
                                    <!-- you dont have a account?
                                    <a href="/userregister" class=""><b>Register</b></a>
                                </span>
                            </div> -->
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

 <!-- axios cdn -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.3/axios.min.js"></script>

 <!-- sweet alert cdn -->
 <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script> 
 <script>

let email = document.getElementById('email');
let emailwarning = document.getElementById('emailwarning');
let mobile;

function validate() {
    
    event.preventDefault()
    let form = event.target.form;
    let validation = true;

    document.getElementById('errmsg').innerHTML ="";
    console.log('hiii')
    emailwarning.innerHTML = "";
    console.log(email.value);
    if(email.value == "") {
        emailwarning.innerHTML = "please enter your email";
        validation= false;
    }
    if(validation){
        email = email.value;
        console.log("hoooo")
        try {
            $.ajax({
                url:'/forgotpassword' ,
                method:"post",
                data:{email},
                success: (res)=>{
                    console.log(res);
                    if(res.status==true ){
                        mobile =res.mobile
                        console.log(mobile,"this is mobile number")
                        document.getElementById("superdiv").innerHTML =
                        `     <form id="myform">
                    <div>
                      <span>A code has been sent to</span> <small>${res.mobile}</small>
                    </div>

                      <span class="ec-login-wrap">
                          <label>OTP</label>
                          <input type="text" name="otp" id="otpid" placeholder="Enter your otp"  maxlength="6" onkeyup="otpcheck()" required />
                      </span>
                      <p class="ml-5 text-danger" id="errmsg" style="display: none" >
                        OTP verification failed
                    </p>
                      <span class="ec-login-wrap ec-login-btn">
                          <!-- <button class="btn btn-primary" type="submit">verify</button> -->
                          <!-- <a href="register.html" class="btn btn-secondary">Register</a> -->
                      </span>
                  </form>
                        `;


                    }
                    else{
                        document.getElementById("errmsg").innerHTML=res.response;
                    }

                }
            })
            console.log("suceess");


        } catch (error) {

            console.log(error);
                console.log(4444);

        }




}
else{
    console.log("error");
}
}

function otpcheck(){
console.log("ortttcheck","hhhhhhhhhhhhhhhhhhhh");
console.log(mobile,"this is otp check mobile")
let otp = document.getElementById('otpid').value;
if(otp.length == 6){
    document.getElementById('otpid').disabled = true;
    try {
        $.ajax({
           url:'/forgotOtp',
            method:"post",
            data:{otp,mobile},
            success:(res)=>{
                console.log("res")
                if(res.response){
                   document.getElementById("superdiv").innerHTML=
                   ` <form id="myform">
                       <span class="ec-login-wrap">
                           <label>Create your new password</label>
                           
                       </span>
                       <span class="ec-register-wrap ec-register-half">
                           <label>password *</label>
                           <p class="text-danger fw-light opacity-75" id="passwordidwarning"></p>
                           <input type="text" name="password" id="password" placeholder="enter password" onkeyup="passwordkey()" required/>
                          
                       </span>
                       <span class="ec-register-wrap ec-register-half">
                           <label>Confirm password *</label>
                           <p class="text-danger fw-light opacity-75" id="password2idwarning"></p>
                           <input type="text" name="Confirmpassword" id="confirmpassword" placeholder="Confirm password" onkeyup="confirmkey()" required />
                          
                       </span>
  
                       <span class="ec-register-wrap ec-register-btn">
                           <button class="btn btn-primary" type="submit"  onclick="validatesignup()">Signup</button>
                       </span>
                       
                       </form>
                   `;
                   

                   

                }else {
                       document.getElementById("otpid").value = "";
                       document.getElementById("otpid").disabled = false;
                       document.getElementById("errmsg").style.display = "";
                }
            }
        })
          
        
    } catch (error) {
       console.log(error)

    }
}

}

function validatesignup() {
       let password = document.getElementById("password"),
           password2 = document.getElementById("confirmpassword");
       let passwordwarning = document.getElementById("passwordidwarning"),
           password2warning = document.getElementById("password2idwarning");
       passwordwarning.innerHTML = "";
       password2warning.innerHTML = "";
       event.preventDefault();
       let form = event.target.form;
       let validation = true;
       if (password.value === "") {
           passwordwarning.innerHTML = "Please enter a password";
           validation = false;
       } else if (password.value.length < 6 || password.value.length > 12) {
           passwordwarning.innerHTML = "Password should be between 6 to 12 letters";
           validation = false;
       } else if (password2.value === "") {
           password2warning.innerHTML = "Please confirm your password";
           validation = false;
       } else if (password.value != password2.value) {
           password2warning.innerHTML = "Password confirmation is failed";
           validation = false;
       }

       if(validation){
           try {
               console.log("jiiiiiiiiii")
               console.log(email,"this is valid email address")
               $.ajax({
                   
                   url:'/changepassword',
                   method:"patch",
                   data:{email:email,
                   password:password.value},
                   success:(res)=>{
                       const Toast = Swal.mixin({
                           toast: true,
                           showConfirmButton: false,
                           timer: 3000,
                           timerProgressBar: true,
                           didOpen: (toast) => {
                               toast.addEventListener("mouseenter", Swal.stopTimer);
                               toast.addEventListener("mouseleave", Swal.resumeTimer);
                           },
                       });
                       if(res.error){
                            Toast.fire({
                               icon: "error",
                               title: res.error,
                               
                           })
                       }else if(res.status){
                            Toast.fire({
                               icon: "success",
                               title: "your password  updated",
                               
                           });
                           location.href ="/userlogin"
                       }else{
                                Toast.fire({
                               icon: "error",
                               title: "Something went wrong",
                               
                           })
                       }
                     
              
                   }
               })
           } catch (error) {
               console.log(error)
               
           }
       }
       
   }


        function passwordkey() {
           passwordwarning.innerHTML = "";
       }
       function confirmkey() {
           password2warning.innerHTML = "";
       }

 </script>
    
    <!-- Vendor JS -->
    <script src="/user/js/vendor/jquery-3.5.1.min.js"></script>
    <script src="/user/js/vendor/popper.min.js"></script>
    <script src="/user/js/vendor/bootstrap.min.js"></script>
    <script src="/user/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="/user/js/vendor/modernizr-3.11.2.min.js"></script>

    <!--Plugins JS-->
    <script src="/user/js/plugins/swiper-bundle.min.js"></script>
    <script src="/user/js/plugins/countdownTimer.min.js"></script>
    <script src="/user/js/plugins/scrollup.js"></script>
    <script src="/user/js/plugins/jquery.zoom.min.js"></script>
    <script src="/user/js/plugins/slick.min.js"></script>
    <script src="/user/js/plugins/infiniteslidev2.js"></script>
    <script src="/user/js/vendor/jquery.magnific-popup.min.js"></script>
    <script src="/user/js/plugins/jquery.sticky-sidebar.js"></script>
    <!-- Google translate Js -->
    <script src="/user/js/vendor/google-translate.js"></script>
    <script>
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({ pageLanguage: 'en' }, 'google_translate_element');
        }
    </script>
    <!-- Main Js -->
    <script src="/user/js/vendor/index.js"></script>
    <script src="/user/js/main.js"></script>

</body>

<!-- Mirrored from loopinfosol.in/themeforest/ekka-html-v33/ekka-html/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 08 Jan 2023 23:18:35 GMT -->
</html>